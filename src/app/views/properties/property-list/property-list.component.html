<div class="bg-white rounded-xl shadow-sm p-6">
    <!-- Cabeçalho -->
    <div class="flex justify-between items-center mb-6">
        <h1 class="flex items-center text-2xl font-bold text-gray-800">
            <i class="pi pi-building mr-2 text-indigo-600"></i>
            <span>Empreendimentos</span>
        </h1>
        <button *ngIf="authService.isAdmin()" (click)="navigateToCreate()"
            class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition duration-300">
            <i class="pi pi-plus"></i>
            <span>Novo Empreendimento</span>
        </button>
    </div>

    <div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
        <app-advanced-filter (filterChange)="applyFilter($event)"></app-advanced-filter>
    </div>

    <!-- Tabela -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100"
                            (click)="sort('name')">
                            Nome
                            <i class="ml-1 pi" [class.pi-sort-alt]="sortField !== 'name'"
                                [class.pi-sort-up]="sortField === 'name' && sortOrder === 1"
                                [class.pi-sort-down]="sortField === 'name' && sortOrder === -1"></i>
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Endereço
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Gestores
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Status
                        </th>
                        <th scope="col"
                            class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Ações
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let property of filteredProperties" class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            {{property.name}}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            {{property.address | truncate:30}}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex flex-wrap gap-2">
                                <span *ngFor="let manager of property.managers | slice:0:2"
                                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    {{ getManagerName(manager.managerId) | async }}
                                </span>
                                <span *ngIf="property.managers.length > 2"
                                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    +{{property.managers.length - 2}}
                                </span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                                [class.bg-green-100]="property.isActive" [class.text-green-800]="property.isActive"
                                [class.bg-red-100]="!property.isActive" [class.text-red-800]="!property.isActive">
                                {{property.isActive ? 'Ativo' : 'Inativo'}}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <div class="flex justify-end gap-2">
                                <button routerLink="/properties/{{property.id}}"
                                    class="p-2 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded-full transition duration-300"
                                    title="Visualizar">
                                    <i class="pi pi-eye"></i>
                                </button>
                                <button *ngIf="authService.isAdmin()" routerLink="/properties/{{property.id}}/edit"
                                    class="p-2 text-yellow-600 hover:text-yellow-900 hover:bg-yellow-50 rounded-full transition duration-300"
                                    title="Editar">
                                    <i class="pi pi-pencil"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Mensagem quando não há dados -->
        <div *ngIf="filteredProperties.length === 0 && !loading" class="text-center py-8 text-gray-500">
            <i class="pi pi-info-circle mr-2"></i>
            Nenhum empreendimento encontrado
        </div>

        <!-- Loading -->
        <div *ngIf="loading" class="flex justify-center items-center py-8">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
        </div>

        <!-- Paginação (opcional) -->
        <div *ngIf="filteredProperties.length > 0" class="px-6 py-3 border-t border-gray-200">
            <div class="flex items-center justify-between">
                <div class="text-sm text-gray-500">
                    Mostrando {{filteredProperties.length}} de {{properties.length}} registros
                </div>
                <!-- Adicionar controles de paginação aqui se necessário -->
            </div>
        </div>
    </div>
</div>